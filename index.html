<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Padel Dashboard 2.0 ‚Äì Admin</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        background: url('https://upload.wikimedia.org/wikipedia/commons/e/e7/Padel_court_2.jpg') no-repeat center center fixed;
        background-size: cover;
        color: white;
    }
    body::before {
        content: "";
        position: fixed;
        top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0,0,0,0.6);
        z-index: -1;
    }
    header {
        text-align: center;
        padding: 15px;
        font-size: 1.8em;
        font-weight: bold;
        background: rgba(0, 0, 0, 0.5);
    }
    header small {
        display: block;
        font-size: 0.8em;
        color: #ffd700;
    }
    .container {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        padding: 20px;
    }
    section {
        background: rgba(0, 0, 0, 0.7);
        padding: 15px;
        border-radius: 10px;
        flex: 1;
        min-width: 300px;
    }
    h2 {
        margin-top: 0;
        color: #ffd700;
    }
    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 8px;
    }
    th, td {
        padding: 6px;
        border-bottom: 1px solid #555;
        text-align: center;
    }
    th {
        background: #1e90ff;
        color: white;
    }
    input, select {
        padding: 5px;
        margin: 3px;
    }
    button {
        padding: 6px 12px;
        margin: 3px;
        background: #1e90ff;
        border: none;
        color: white;
        border-radius: 5px;
        cursor: pointer;
    }
    button:hover {
        background: #63b3ed;
    }
    .winner {
        color: lightgreen;
    }
    @media (max-width: 900px) {
        .container {
            flex-direction: column;
        }
    }
</style>
</head>
<body>

<header>
    üéæ Padel Dashboard 2.0 ‚Äì Admin
    <small id="currentDate"></small>
</header>

<div style="text-align:center; padding:10px;">
    <input type="text" id="newPlayer" placeholder="Naam speler">
    <button onclick="addPlayer()">Speler toevoegen</button>
    <button style="background:red;" onclick="resetAll()">Reset Toernooi</button>
</div>

<div style="text-align:center; padding:10px;">
    <input type="number" id="numCourts" min="1">
    <input type="text" id="courtTimes">
    <button onclick="saveCourts()">Banen & tijden opslaan</button>
</div>

<div class="container">
    <section>
        <h2>üèÜ Leaderboard</h2>
        <table id="leaderboard">
            <thead>
                <tr>
                    <th>Actief</th>
                    <th>Naam</th>
                    <th>Punten</th>
                    <th>Gespeeld</th>
                    <th>Winst</th>
                    <th>Verlies</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </section>

    <section>
        <h2>üìÖ Speelschema</h2>
        <button onclick="generateSchedule()">Genereer Schema</button>
        <table id="schedule">
            <thead>
                <tr>
                    <th>Tijd</th>
                    <th>Baan</th>
                    <th>Wedstrijd</th>
                    <th>Winnaar</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </section>
</div>

<script>
let players = JSON.parse(localStorage.getItem('players')) || [];
let courts = JSON.parse(localStorage.getItem('courts')) || {num: 3, times: ["11:15", "12:00", "12:45"]};
let schedule = JSON.parse(localStorage.getItem('schedule')) || [];

document.getElementById("numCourts").value = courts.num;
document.getElementById("courtTimes").value = courts.times.join(", ");
document.getElementById("currentDate").textContent = new Date().toLocaleDateString('nl-NL', { weekday:"long", year:"numeric", month:"long", day:"numeric" });

function saveData() {
    localStorage.setItem('players', JSON.stringify(players));
    localStorage.setItem('courts', JSON.stringify(courts));
    localStorage.setItem('schedule', JSON.stringify(schedule));
}

function addPlayer() {
    let name = document.getElementById("newPlayer").value.trim();
    if(name) {
        players.push({name, points: 0, played: 0, wins: 0, losses: 0, active: false});
        document.getElementById("newPlayer").value = "";
        updateLeaderboard();
        saveData();
    }
}

function toggleActive(index) {
    players[index].active = !players[index].active;
    saveData();
}

function updatePoints(index, value) {
    players[index].points = parseInt(value) || 0;
    saveData();
}

function saveCourts() {
    courts.num = parseInt(document.getElementById("numCourts").value);
    courts.times = document.getElementById("courtTimes").value.split(",").map(t => t.trim());
    saveData();
}

function updateLeaderboard() {
    let tbody = document.querySelector("#leaderboard tbody");
    tbody.innerHTML = "";
    players.sort((a,b) => b.points - a.points);
    players.forEach((p,i) => {
        tbody.innerHTML += `
        <tr>
            <td><input type="checkbox" ${p.active ? 'checked' : ''} onclick="toggleActive(${i})"></td>
            <td>${p.name}</td>
            <td><input type="number" value="${p.points}" onchange="updatePoints(${i}, this.value)" style="width:50px"></td>
            <td>${p.played}</td>
            <td>${p.wins}</td>
            <td>${p.losses}</td>
        </tr>`;
    });
}

function generateSchedule() {
    let activePlayers = players.filter(p => p.active);
    if(activePlayers.length < 4) {
        alert("Minimaal 4 actieve spelers nodig!");
        return;
    }
    activePlayers.sort((a,b) => b.points - a.points);
    let high = [...activePlayers];
    let low = high.splice(Math.ceil(activePlayers.length / 2));
    schedule = [];
    courts.times.forEach(time => {
        for(let c = 1; c <= courts.num; c++) {
            if(high.length > 0 && low.length > 0) {
                let p1 = high.shift();
                let p2 = low.shift();
                let p3 = high.length > 0 ? high.pop() : null;
                let p4 = low.length > 0 ? low.pop() : null;
                if(p1 && p2 && p3 && p4) {
                    schedule.push({time, court: c, match: `${p1.name} & ${p4.name} vs ${p2.name} & ${p3.name}`, winner: ""});
                }
            }
        }
    });
    updateSchedule();
    saveData();
}

function setWinner(index, team) {
    let match = schedule[index];
    if(!match) return;

    let [team1, , team2] = match.match.split(" vs ");
    let team1Players = team1.split(" & ");
    let team2Players = team2.split(" & ");

    let winners = team === "team1" ? team1Players : team2Players;
    let losers = team === "team1" ? team2Players : team1Players;

    players.forEach(p => {
        if(winners.includes(p.name)) {
            p.wins++;
            p.played++;
            p.points += 3;
        } else if(losers.includes(p.name)) {
            p.losses++;
            p.played++;
        }
    });

    match.winner = team === "team1" ? team1 : team2;
    updateLeaderboard();
    updateSchedule();
    saveData();
}

function updateSchedule() {
    let tbody = document.querySelector("#schedule tbody");
    tbody.innerHTML = "";
    schedule.forEach((s, i) => {
        tbody.innerHTML += `
        <tr>
            <td>${s.time}</td>
            <td>${s.court}</td>
            <td>${s.match}</td>
            <td>
                <select onchange="setWinner(${i}, this.value)">
                    <option value="">Kies winnaar</option>
                    <option value="team1">Team 1 wint</option>
                    <option value="team2">Team 2 wint</option>
                </select>
                ${s.winner ? `<span class="winner">${s.winner}</span>` : ""}
            </td>
        </tr>`;
    });
}

function resetAll() {
    if(confirm("Weet je zeker dat je alles wilt resetten?")) {
        players = [];
        courts = {num: 3, times: ["11:15", "12:00", "12:45"]};
        schedule = [];
        saveData();
        updateLeaderboard();
        updateSchedule();
    }
}

updateLeaderboard();
updateSchedule();
</script>

</body>
</html>
